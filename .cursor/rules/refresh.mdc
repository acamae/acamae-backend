---
description:
globs:
alwaysApply: false
---
---
description: To be used when fixing errors, not only on tests but anywhere
---

Diagnose and resolve the issue described above using a systematic, validation-driven approach:

**Refresh Token Guidelines**

* **Security**:
  - Use short-lived tokens (15-30 min)
  - Implement blacklist
  - Rotate refresh tokens
  - Validate fingerprint
  - Verify IP
  - Sanitize tokens

* **Storage**:
  - Use Redis for blacklist
  - Implement TTL
  - Clean expired tokens
  - Encrypt tokens
  - Validate storage
  - Monitor usage

* **Validation**:
  - Verify signature
  - Validate expiration
  - Check blacklist
  - Verify fingerprint
  - Validate IP
  - Sanitize input

This process ensures a thorough, efficient resolution that strengthens the codebase while directly addressing the reported issue.
